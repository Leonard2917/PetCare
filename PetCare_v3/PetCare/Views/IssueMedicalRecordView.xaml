<Window x:Class="PetCare.Views.IssueMedicalRecordView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Emitere Fișă Medicală" Height="750" Width="700" WindowStartupLocation="CenterScreen">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Emitere Fișă Medicală" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

        <StackPanel Grid.Row="1" Margin="0,0,0,15">
            <TextBlock Text="Diagnostic (Opțional)" Margin="0,0,0,5" Foreground="#666"/>
            <TextBox Text="{Binding Diagnostic}" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Padding="5"/>
        </StackPanel>

        <StackPanel Grid.Row="2" Margin="0,0,0,15">
            <TextBlock Text="Tratament / Observații" Margin="0,0,0,5" Foreground="#666"/>
            <TextBox Text="{Binding Tratament}" Height="80" TextWrapping="Wrap" AcceptsReturn="True" Padding="5"/>
        </StackPanel>

        <GroupBox Grid.Row="3" Header="Materiale Utilizate" Margin="0,0,0,15">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Left: Add Controls -->
                <StackPanel Grid.Column="0" Margin="0,0,10,0" VerticalAlignment="Top">
                     <TextBlock Text="Material" Margin="0,0,0,2"/>
                     <ComboBox ItemsSource="{Binding AvailableMaterials}" 
                              SelectedItem="{Binding SelectedAvailableMaterial}"
                              DisplayMemberPath="DenumireProdus" Width="180" Margin="0,0,0,10"/>
                     
                     <TextBlock Text="Cantitate" Margin="0,0,0,2"/>
                     <TextBox Text="{Binding MaterialQuantity}" Width="180" Margin="0,0,0,10" Padding="5"/>
                     
                     <Button Content="Adaugă" Click="AddMaterial_Click" Background="#2196F3" Foreground="White" Padding="10,5" BorderThickness="0"/>
                </StackPanel>

                <!-- Right: List -->
                <DataGrid Grid.Column="1" 
                          ItemsSource="{Binding UsedMaterials}" 
                          MinHeight="120"
                          MaxHeight="200"
                          AutoGenerateColumns="False" 
                          CanUserAddRows="False" 
                          IsReadOnly="True" 
                          HeadersVisibility="Column"
                          GridLinesVisibility="All"
                          Background="#FAFAFA"
                          BorderThickness="1" 
                          BorderBrush="#CCC"
                          VerticalScrollBarVisibility="Auto">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Material" Binding="{Binding NumeMaterial}" Width="*"/>
                        <DataGridTextColumn Header="Cantitate" Binding="{Binding Cantitate}" Width="80"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </GroupBox>

        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,15">
            <TextBlock Text="Total Estimativ (Servicii + Materiale): " FontWeight="Bold"/>
            <TextBlock Text="{Binding TotalCost, StringFormat={}{0:F2} RON}" FontWeight="Bold" Foreground="#4CAF50" FontSize="14"/>
        </StackPanel>

        <GroupBox Grid.Row="5" Header="Reminder" Margin="0,0,0,15">
            <StackPanel Margin="5">
                <CheckBox Content="Adaugă Reminder" IsChecked="{Binding AddReminder}" Margin="0,0,0,10"/>
                <StackPanel IsEnabled="{Binding AddReminder}">
                    <DatePicker SelectedDate="{Binding ReminderDate}" Margin="0,0,0,5" HorizontalAlignment="Left" Width="150"/>
                    <TextBox Text="{Binding ReminderMessage}" Height="40" TextWrapping="Wrap" AcceptsReturn="True" Padding="5" ToolTip="Mesaj Reminder"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Anulează" IsCancel="True" Padding="20,10" Margin="0,0,10,0"/>
            <Button Content="Salvează Fișa" Click="SaveButton_Click" Padding="20,10" Background="#4CAF50" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
        </StackPanel>
    </Grid>
</Window>
