<UserControl x:Class="PetCare.Views.StatisticsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="10">
            <TextBlock Text="Statistici Generale" FontSize="24" FontWeight="Bold" Margin="0,0,0,20" Foreground="#2C3E50"/>

            <UniformGrid Columns="2">
                <!-- Top Clinics -->
                <GroupBox Header="Top 5 Clinici (Popularitate)" Margin="5" Padding="5">
                    <DataGrid ItemsSource="{Binding TopClinics}" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column" Background="White" Height="150">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Clinică" Binding="{Binding NumeClinica}" Width="*"/>
                            <DataGridTextColumn Header="Programări Finalizate" Binding="{Binding TotalProgramari}" Width="Auto"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

                <!-- Top Medics -->
                <GroupBox Header="Top 5 Medici (Popularitate)" Margin="5" Padding="5">
                    <DataGrid ItemsSource="{Binding TopMedics}" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column" Background="White" Height="150">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Medic" Binding="{Binding NumeMedic}" Width="*"/>
                            <DataGridTextColumn Header="Clinică" Binding="{Binding NumeClinica}" Width="*"/>
                            <DataGridTextColumn Header="Total" Binding="{Binding TotalProgramari}" Width="Auto"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

                <!-- Animal Distribution -->
                <GroupBox Header="Distribuție Specii Animale" Margin="5" Padding="5">
                    <DataGrid ItemsSource="{Binding AnimalStats}" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column" Background="White" Height="150">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Specie" Binding="{Binding TipAnimal}" Width="*"/>
                            <DataGridTextColumn Header="Număr" Binding="{Binding Numar}" Width="Auto"/>
                            <DataGridTextColumn Header="Procent" Binding="{Binding Procent, StringFormat={}{0}%}" Width="Auto"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

                <!-- Admin Only: Top Materials -->
                <GroupBox Header="Consum Stock (Top Materiale)" Margin="5" Padding="5" 
                          Visibility="{Binding IsAdmin, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <DataGrid ItemsSource="{Binding TopMaterials}" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column" Background="White" Height="150">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Material" Binding="{Binding NumeMaterial}" Width="*"/>
                            <DataGridTextColumn Header="Cantitate Totală" Binding="{Binding CantitateTotala}" Width="Auto"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </UniformGrid>

            <!-- Admin Only: Revenue per Medic (Full Width) -->
            <GroupBox Header="Performanță Financiară per Medic (Clinica Curentă)" Margin="5" Padding="5" 
                      Visibility="{Binding IsAdmin, Converter={StaticResource BooleanToVisibilityConverter}}">
                <DataGrid ItemsSource="{Binding RevenueStats}" AutoGenerateColumns="False" IsReadOnly="True" HeadersVisibility="Column" Background="White" MinHeight="150">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Medic" Binding="{Binding NumeEntitate}" Width="*"/>
                        <DataGridTextColumn Header="Venit Total Generat (RON)" Binding="{Binding TotalVenit, StringFormat=F2}" Width="150"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</UserControl>
